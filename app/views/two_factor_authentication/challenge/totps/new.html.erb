<div class="p-4 i-full bg-main" style="max-inline-size: 25rem;">
  <div class="text-center">
    <div class="mbe-5">
      <%= link_to root_path, class: "block" do %>
        <span class="icon icon--audio-waveform p-8" aria-hidden="true"></span>
      <% end %>
    </div>
    <h1 class="font-semibold text-2xl mbe-5">Two-Factor Verification</h1>
  </div>

  <% if alert.present? %>
    <div class="alert alert--negative text-center mbe-4" role="alert">
      <%= alert %>
    </div>
  <% end %>

  <%= form_with(url: two_factor_authentication_challenge_totp_path) do |form| %>
    <div class="mbe-5">
      <%= form.label :code, "Open your authenticator app and enter the six-digit code.", class: "font-semibold mbe-2 block text-center" %>
      <%= form.text_field :code, autofocus: true, required: true, autocomplete: :off, class: "input i-full text-center", style: "font-size: 1.5rem; letter-spacing: 0.5rem;" %>
    </div>

    <div>
      <%= form.submit "Verify", class: "btn btn--primary i-full" %>
    </div>
  <% end %>

  <div class="border-b border-main mbs-5 mbe-5"></div>

  <div class="text-sm text-center">
    <p class="text-subtle mbe-2">Can't use your authenticator app?</p>
    <%= link_to "Use a recovery code", new_two_factor_authentication_challenge_recovery_codes_path, class: "text-link" %>
    <% if @user.security_keys.exists? %>
      <span class="mis-1 mie-1">|</span>
      <%= link_to "Use a security key", new_two_factor_authentication_challenge_security_keys_path, class: "text-link" %>
    <% end %>
  </div>
</div>